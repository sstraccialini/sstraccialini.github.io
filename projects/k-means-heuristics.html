<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Primary Meta Tags -->
  <title>K-Means Clustering Heuristics - Samuele Nicolò Straccialini</title>
  <meta name="title" content="K-Means Clustering Heuristics - Samuele Nicolò Straccialini">
  <meta name="description" content="Bachelor's thesis exploring novel heuristics for efficient and accurate k-means clustering, including the extended-Hartigan algorithm.">
  <meta name="author" content="Samuele Nicolò Straccialini">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://sstraccialini.github.io/projects/k-means-heuristics.html">
  <meta property="og:title" content="K-Means Clustering Heuristics - Samuele Nicolò Straccialini">
  <meta property="og:description" content="Bachelor's thesis exploring novel heuristics for efficient and accurate k-means clustering.">
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://sstraccialini.github.io/projects/k-means-heuristics.html">
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="../assets/favicon.svg">
  <link rel="icon" type="image/png" sizes="32x32" href="../assets/favicon-32x32.png">
  <meta name="theme-color" content="#2563eb">
  
  <!-- Stylesheet -->
  <link rel="stylesheet" href="../css/styles.css">
  
  <!-- KaTeX for Math Rendering -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" crossorigin="anonymous">
</head>
<body>
  <!-- Skip Link for Accessibility -->
  <a href="#main-content" class="skip-link">Skip to main content</a>
  
  <!-- Header -->
  <header class="header" id="header">
    <div class="container header__inner">
      <a href="../index.html" class="header__logo" aria-label="Samuele Nicolò Straccialini - Home">SNS</a>
      
      <nav class="nav" aria-label="Main navigation">
        <a href="../index.html" class="nav__link">Home</a>
        <a href="../about.html" class="nav__link">About</a>
        <a href="../projects.html" class="nav__link active">Projects</a>
        <a href="../contact.html" class="nav__link">Contact</a>
      </nav>
      
      <div class="header__actions">
        <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
          <svg class="theme-toggle__icon theme-toggle__icon--light" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <circle cx="12" cy="12" r="4"></circle>
            <path d="M12 2v2"></path>
            <path d="M12 20v2"></path>
            <path d="m4.93 4.93 1.41 1.41"></path>
            <path d="m17.66 17.66 1.41 1.41"></path>
            <path d="M2 12h2"></path>
            <path d="M20 12h2"></path>
            <path d="m6.34 17.66-1.41 1.41"></path>
            <path d="m19.07 4.93-1.41 1.41"></path>
          </svg>
          <svg class="theme-toggle__icon theme-toggle__icon--dark" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
          </svg>
        </button>
        
        <button class="menu-toggle" id="menu-toggle" aria-label="Open menu" aria-expanded="false" aria-controls="mobile-nav">
          <svg class="menu-toggle__icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <line x1="4" x2="20" y1="12" y2="12"></line>
            <line x1="4" x2="20" y1="6" y2="6"></line>
            <line x1="4" x2="20" y1="18" y2="18"></line>
          </svg>
        </button>
      </div>
    </div>
  </header>
  
  <!-- Mobile Navigation -->
  <nav class="mobile-nav" id="mobile-nav" aria-label="Mobile navigation">
    <a href="../index.html" class="mobile-nav__link">Home</a>
    <a href="../about.html" class="mobile-nav__link">About</a>
    <a href="../projects.html" class="mobile-nav__link active">Projects</a>
    <a href="../contact.html" class="mobile-nav__link">Contact</a>
  </nav>
  
  <!-- Main Content -->
  <main id="main-content">
    <!-- Project Header -->
    <section class="section">
      <div class="container">
        <a href="../projects.html" class="btn btn--secondary" style="margin-bottom: var(--space-6);">
          <svg class="btn__icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" style="margin-right: 0.5rem; margin-left: 0;">
            <path d="m12 19-7-7 7-7"></path>
            <path d="M19 12H5"></path>
          </svg>
          Back to Projects
        </a>
        
        <header class="project-header" data-project-id="k-means-heuristics">
          <h1 class="project-header__title"></h1>
          <p class="project-header__description"></p>
          
          <div class="project-header__tags">
            <!-- Tags loaded from projects-data.js -->
          </div>
          
          <div class="project-header__actions">
            <!-- Buttons loaded from projects-data.js -->
          </div>
        </header>
      </div>
    </section>
    
    <!-- Project Content -->
    <section class="section" style="padding-top: 0;">
      <div class="container">
        <div class="project-layout">
          <!-- Main Content -->
          <div class="project-content">
            <article class="card">
              <div class="prose markdown-content">
<!-- PASTE YOUR README MARKDOWN BELOW THIS LINE -->
# An exploration of novel heuristics for efficient and accurate $k$-means clustering

This repository contains the code written to develop and test the algorithms described in my Bachelor's final thesis.

## Table of Contents
- [An exploration of novel heuristics for efficient and accurate $k$-means clustering](#an-exploration-of-novel-heuristics-for-efficient-and-accurate-k-means-clustering)
  - [Table of Contents](#table-of-contents)
  - [Abstract](#abstract)
  - [Repository Structure](#repository-structure)
  - [Extended-Hartigan pseudocode](#extended-hartigan-pseudocode)
  - [Datasets](#datasets)
  - [References](#references)

## Abstract

$K$-means is one of the most widely-used algorithms to perform clustering and exploratory data analysis, since it allows identifying relevant patterns in data. Its objective is to partition a set of observations into a predetermined number of clusters, by minimizing the within-cluster sum of squares (WCSS). However, this optimization problem is NP-hard, necessitating the use of heuristic algorithms for practical applications. The most common heuristic, Lloyd's algorithm, is simple and efficient, but at the same time it is highly susceptible to converging to suboptimal local minima, with its performance being heavily dependent on the centroids' initial positions. While alternatives, such as Hartigan's algorithm, have been proven to find better (lower-cost) solutions, they are often significantly slower and more computationally intensive.

This thesis introduces and evaluates a novel heuristic, "extended-Hartigan", designed to bridge this gap by reducing the computational complexity of the standard Hartigan's method while retaining its ability to find high-quality clusterings. The proposed algorithm deviates from the standard single-point update rule. Instead, it first identifies all candidate data points whose reassignment would individually decrease the total cost, following Hartigan's procedure, and then attempts to apply this entire list of reassignments in a single "unsafe" batch update. If this aggressive update fails to lower the overall cost, the algorithm reverts the changes and proceeds in a "safe" mode, accepting a limited subset of non-conflicting reassignments to guarantee a monotonic cost reduction in that iteration.

To validate this approach, we conduct an empirical study comparing extended-Hartigan and its hybrid "mixed-mode" variants against the classical Lloyd's and Hartigan's algorithms. The evaluation spans several benchmark datasets, which feature diverse numbers of samples, dimensions, and cluster counts. The comparison is performed using multiple initialization techniques, including maximin, $k$-means++, and greedy $k$-means++, and performance is assessed based on the final cost, computational efficiency, and clustering stability. The results demonstrate that the proposed methods consistently find clusterings with a lower final cost than Lloyd's algorithm, achieving a significant cost reduction on the most complex datasets. Moreover, extended-Hartigan avoids the computational instability inherent in the standard Hartigan algorithm, showing a cost profile closer to the efficient Lloyd's baseline and successfully preventing extreme cost increases. The findings indicate that the extended-Hartigan algorithm is a robust and efficient alternative that successfully balances the trade-off between solution quality and computational expense, offering a practical and powerful alternative for $k$-means clustering.

## Repository Structure
Here's the structure of this repository:

- `data`: contains some datasets on which the algorithms where tested.
- `iter_records`: contains some records of safe and unsafe iterations using our proposed `extended-hartigan` algorithm, mainly for an illustrative scope.
- `latex`: contains the latex-formatted tables of results which are included in the Appendix of the final work.
- `misc`: contains a bunch of experimental code, proofs-of-concept (PoCs), and isolated tests developed during the main project's lifecycle. The code within this folder is not part of the final application, is not actively maintained, and can be safely ignored for any production build. It serves as a development 'sandbox' for trying out new ideas.
- `profiling`: contains some profiling code to speed up the algorithms; used during development phase.
- `tests`: contains all tests results.
- `utils`: contains some other useful code which is not directly related with the developed algorithms (such as code for results visualization and so on...).
- `Abstract.txt`: the abstract of the final work
- **`kmeans.ipynb`: the actual notebook containing all algorithms developed.**
- `Tesi-final.pdf`: the final version of my thesis work.

## Extended-Hartigan pseudocode

One of the main contribution of this work is the algorithm we called `extended-Hartigan`. Here follows its pseudocode.

```
choose k = number of centroids

assign points to each centroid randomly
move the centroid to the mean of points assigned to it

repeat:
    for each datapoint d ∈ c
        for each centroid c' ≠ c
            compute Δcost(d; c → c')
            | if result is negative, store in a candidates list
            | if candidate is already in list keep the reassignment with minimum Δcost
        end for
    end for

    if "unsafe mode":
        accept all candidates
        if overall cost did not decrease
            revert changes and proceed in "safe mode"
    else if "safe mode"
        sort all candidates (minimum first)
        accept them in order if the corresponding clusters have not been involved
 
until convergence
```

## Datasets

The main datasets used in this work where *A-Sets* from a research project by Karkkainen
and Franti [KF02], Bridge and House, from a work by Franti, Rezaei, and Zhao [FRZ14]. These, and other datasets which are used for clustering tasks, are available in the following website: https://cs.joensuu.fi/sipu/datasets/.

## References

[AV07] David Arthur and Sergei Vassilvitskii. “K-Means++: The Advantages of Careful
Seeding”. In: vol. 8. Jan. 2007, pp. 1027–1035. doi: 10.1145/1283383.1283494.

[Bha+19] Anup Bhattacharya et al. Noisy, Greedy and Not So Greedy k-means++. Dec.
2019. doi: 10.48550/arXiv.1912.00653. url: http://arxiv.org/abs/1912.00653.

[Elk03] Charles Elkan. “Using the triangle inequality to accelerate k-means”. In: Proceed-
ings of the Twentieth International Conference on International Conference on
Machine Learning. ICML’03. Washington, DC, USA: AAAI Press, 2003, pp. 147–
153. isbn: 1577351894.

[FRZ14] Pasi Franti, Mohammad Rezaei, and Qinpei Zhao. “Centroid index: Cluster level
similarity measure”. en. In: Pattern Recognition 47.9 (Sept. 2014), pp. 3034–
3045. issn: 00313203. doi: 10 . 1016 / j . patcog . 2014 . 03 . 017. url: https://linkinghub.elsevier.com/retrieve/pii/S0031320314001150.

[Gru+22] Christoph Grunau et al. A Nearly Tight 0Analysis of Greedy k-means++. July
2022. doi: 10.48550/arXiv.2207.07949. url: http://arxiv.org/abs/2207.07949.

[Har75] John A. Hartigan. Clustering algorithms. eng. A Wiley publication in applied
statistics. New York: Wiley, 1975. isbn: 9780471356455.

[HW79] J. A. Hartigan and M. A. Wong. “Algorithm AS 136: A K-Means Clustering Algo-
rithm”. In: Journal of the Royal Statistical Society. Series C (Applied Statistics)
28.1 (1979), pp. 100–108. issn: 00359254, 14679876. url: http://www.jstor.org/stable/2346830.

[KF02] Ismo Karkkainen and Pasi Franti. Dynamic local search algorithm for the cluster-
ing problem. eng. Report series / University of Joensuu, Department of Computer
Science. A, 2002-6. OCLC: 58380784. Joensuu: University of Joensuu, 2002. isbn:
9789524581431.

[Llo82] S. Lloyd. “Least squares quantization in PCM”. en. In: IEEE Transactions on
Information Theory 28.2 (Mar. 1982), pp. 129–137. issn: 0018-9448. doi: 10.
1109 / TIT . 1982 . 1056489. url: http://ieeexplore.ieee.org/document/1056489/.

[NF16] James Newling and Francois Fleuret. “Fast k-means with accurate bounds”.
en. In: Proceedings of The 33rd International Conference on Machine Learning.
PMLR, June 2016, pp. 936–944. url: https://proceedings.mlr.press/v48/newling16.html.

[SB14] Shai Shalev-Shwartz and Shai Ben-David. Understanding machine learning: from
theory to algorithms. eng. New York: Cambridge university press, 2014. isbn:
9781107057135.

[Sci] Scikit-learn. KMeans. en. url: https://scikit-learn/stable/modules/generated/sklearn.cluster.KMeans.html.

[TV10] Matus Telgarsky and Andrea Vattani. “Hartigan’s Method: k-means Clustering
without Voronoi”. In: Proceedings of the Thirteenth International Conference on
Artificial Intelligence and Statistics. Ed. by Yee Whye Teh and Mike Titterington.
Vol. 9. Proceedings of Machine Learning Research. Chia Laguna Resort, Sardinia,
Italy: PMLR, May 2010, pp. 820–827. url: https://proceedings.mlr.press/v9/telgarsky10a.html.

[Wu+08] Xindong Wu et al. “Top 10 algorithms in data mining”. en. In: Knowledge and
Information Systems 14.1 (Jan. 2008), pp. 1–37. issn: 0219-1377, 0219-3116. doi:
10.1007/s10115-007-0114-2. url: http://link.springer.com/10.1007/s10115-007-0114-2.

[Xia+22] Shuyin Xia et al. “Ball kk-Means: Fast Adaptive Clustering With No Bounds”.
In: IEEE Transactions on Pattern Analysis and Machine Intelligence 44.1 (Jan.
2022), pp. 87–99. issn: 1939-3539. doi: 10.1109/TPAMI.2020.3008694. url:
https://ieeexplore.ieee.org/document/9139397.
<!-- END OF MARKDOWN CONTENT -->
              </div>
            </article>
          </div>

          <!-- Sidebar -->
          <aside class="project-sidebar">
            <div class="card">
              <h3 class="card__title">Project Details</h3>
              <dl class="project-meta" data-auto>
                <!-- Loaded from projects-data.js -->
              </dl>
            </div>
            
            <div class="card">
              <h3 class="card__title">Technologies Used</h3>
              <div class="tech-list" data-auto>
                <!-- Loaded from projects-data.js -->
              </div>
            </div>
          </aside>
        </div>
      </div>
    </section>
  </main>
  
  <!-- Footer -->
  <footer class="footer">
    <div class="container footer__inner">
      <p class="footer__copyright">© 2025 Samuele Nicolò Straccialini. All rights reserved.</p>
      <div class="footer__links">
        <a href="https://github.com/sstraccialini" target="_blank" rel="noopener noreferrer" class="footer__link">GitHub</a>
        <a href="https://www.linkedin.com/in/samuele-nicolo-straccialini/" target="_blank" rel="noopener noreferrer" class="footer__link">LinkedIn</a>
        <a href="mailto:stra.samuele@gmail.com" class="footer__link">Email</a>
      </div>
    </div>
  </footer>
  
  <!-- KaTeX for Math Rendering -->
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" crossorigin="anonymous"></script>
  
  <!-- Markdown Parser -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  
  <!-- JavaScript -->
  <script src="../js/projects-data.js"></script>
  <script src="../js/main.js"></script>
</body>
</html>
